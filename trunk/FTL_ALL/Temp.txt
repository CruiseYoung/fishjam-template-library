add-in的后台线程必须是STA? 
System.Threading.Thread myThread = new xxx;
myThread.SetApartmentState(System.Threading.ApartmentState.STA);
myThread.Start();

CommandBars集合包含程序中的所有命令条，如：工具条和菜单条
CommandBar对象可以包含其它的 CommandBar 对象，这些对象是作为按钮或菜单命令来用的
每一个CommandBar都将通过CommandBarControls对象被引用
CommandBarControls又可以包含一组CommandBarControl对象
每一个CommandBarControl可以包含一个CommandBar对象，并可以通过它来存取控件属性

CommandBarControl可以有三种表现形式：
 弹出式(CommandBarPopup)：相当于菜单条的一个菜单项。
 组合框(CommandBarComboBox)：类似于工具条中组合框控件。它包括一个工具栏和紧接着工具栏的一个下拉箭头。单击该按钮，将显示出更多的带图标的菜单命令。
 按钮(CommandBarButton)：相当于标准的工具栏按钮，即带有图标的按钮。

Solution -> Prject -> ProjectItems -> ProjectItem
_CommandBars -> CommandBar -> CommandBarControls -> CommandBarControl(Popup) -> Command(AddControl)
Commands -> Command 

Bindings -- 快捷键，如 L"Text Editor::Ctrl+Shift+W, V"

DTE Service Provider
	1 : IVsObjectManager
	2 : _DTE
	3 : IVsCommandWindow
	4 : IVsRegisterFindScope
	5 : IVsAddProjectItemDlg
	6 : IVsStructuredFileIO
	7 : IVsInvisibleEditorManager
	8 : ICQryAutoFactory
	9 : IVsHTMLConverter
	10 : IVsLog
	11 : IVsFileChange
	12 : IUIHostLocale
	13 : IVsEnumHierarchyItemsFactory
	14 : IHxSession
	15 : IHxRegisterSession
	16 : IVsUIShellOpenDocument
	17 : IVsIntelliMouseHandler
	18 : IVsParseCommandLine
	19 : SVsProfilesManagerUI
	20 : IVsFontAndColorStorage
	21 : SVsOnlineHelpData
	22 : SVsSearchService
	23 : Help
	24 : SVsHelpPage
	25 : IVsOutputWindow
	26 : IVsRegisterScciProvider
	27 : IVsMonitorSelection
	28 : SVsWebProxy
	29 : IVsComponentSelectorDlg
	30 : SVsHelpOnlineF1Service
	31 : IVsSolutionPersistence
	32 : IVsLibraryReferenceManager
	33 : IVsCmdNameMapping
	34 : IVsToolbox
	35 : IVsRegisterEditors
	36 : IInternetSecurityManager
	37 : IVsSolution
	38 : IVsdDeployment
	39 : ObjectExtenders
	40 : IVsSolutionBuildManager
	41 : IVsFileChangeEx
	42 : IVsMonitorUserContext
	43 : IVsTaskList
	44 : IVsBuildEventCommandLineDialogService
	45 : SVsStartPageDownload
	46 : IVsRunningDocumentTable
	47 : IVsdPackageManager
	48 : IVsUIShell
	49 : IVsDiscoveryService
	50 : IVsPropertyPageFrame
	51 : IVsAddWebReferenceDlg
	52 : IVsFilterKeys
	53 : IVsTextImageUtilities
	54 : IVsAppCommandLine
	55 : IProfferService
	56 : IVsXMLMemberIndexService
	57 : IVsStatusbar
	58 : IVsUIHierWinClipboardHelper
	59 : IVsExternalFilesManager
	60 : IVsMenuEditorFactory
	61 : IVsdDeployment
	62 : IVsRegisterProjectTypes
	63 : SourceControl
	64 : IVsCodeShareHandler
	65 : SVsLinkedUndoTransactionManager
	66 : IVsShell
	

Marker -- 
  Visual Assist X Current Line,	Visual Assist X Spelling Error,Visual Assist X Syntax Error,
  Visual Assist X Brace Error, Visual Assist X Brace Matching, Visual Assist X Find Reference (Modified),
  Visual Assist X Find Result,Visual Assist X Find Reference, 等
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0\Text Editor\External Markers\